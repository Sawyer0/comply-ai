# Production-grade Risk Scoring Framework Configuration
# This configuration provides enterprise-ready settings for the risk scoring system

risk_scoring:
  # Calculation methodology
  calculation_method: "cvss_enhanced"
  
  # Risk dimension weights (must sum to 1.0)
  risk_weights:
    technical: 0.3      # Technical risk (CVSS-like)
    business: 0.3       # Business impact assessment
    regulatory: 0.25    # Regulatory compliance risk
    temporal: 0.15      # Time-based risk factors
  
  # CVSS-like technical risk configuration
  cvss_config:
    confidentiality_weight: 0.3
    integrity_weight: 0.3
    availability_weight: 0.3
    scope_weight: 0.1
    
    # Attack vector impact multipliers
    attack_vector_multipliers:
      physical: 0.2
      local: 0.55
      adjacent: 0.62
      network: 0.85
    
    # Attack complexity multipliers
    attack_complexity_multipliers:
      low: 0.77
      high: 0.44
  
  # Business context configuration
  business_config:
    size_multiplier: 1.0              # Business size impact (1.0 = medium enterprise)
    industry_type: "technology"       # Industry classification
    critical_processes: []            # List of critical business processes
    system_criticality: {}           # Per-system criticality scores (0.0-1.0)
    process_criticality: {}          # Per-process criticality scores (0.0-1.0)
    
    # Revenue impact thresholds (USD)
    revenue_impact_thresholds:
      low: 10000
      medium: 100000
      high: 1000000
      critical: 10000000
  
  # Regulatory compliance configuration
  regulatory_config:
    applicable_frameworks: []         # List of applicable frameworks (soc2, iso27001, etc.)
    
    # Framework importance weights
    framework_weights:
      soc2: 1.2
      iso27001: 1.1
      hipaa: 1.5
      gdpr: 1.4
      pci_dss: 1.3
      sox: 1.4
      fedramp: 1.6
    
    # Current compliance posture (0.0-1.0)
    compliance_posture:
      soc2: 0.8
      iso27001: 0.8
      hipaa: 0.9
      gdpr: 0.7
      pci_dss: 0.8
      sox: 0.9
      fedramp: 0.8
    
    # Audit frequency multipliers
    audit_frequency:
      soc2: 1.2
      iso27001: 1.1
      hipaa: 1.4
      gdpr: 1.3
      pci_dss: 1.5
      sox: 1.6
      fedramp: 1.8
  
  # Temporal risk assessment configuration
  temporal_config:
    decay_days: 30                    # Days for risk decay
    critical_window_hours: 4          # Critical time window
    high_priority_window_hours: 24    # High priority time window
    
    # Urgency impact weights
    urgency_weights:
      low: 0.8
      medium: 1.0
      high: 1.2
      critical: 1.5
    
    # Risk decay configuration
    decay_function: "exponential"     # linear, exponential, logarithmic
    decay_rate: 0.1
  
  # Performance optimization settings
  performance_config:
    enable_caching: true              # Enable intelligent caching
    cache_ttl_seconds: 300           # Cache time-to-live (5 minutes)
    max_concurrent_calculations: 100  # Maximum concurrent operations
    calculation_timeout_seconds: 30   # Timeout for individual calculations
    
    # Circuit breaker settings
    circuit_breaker_enabled: true
    circuit_breaker_failure_threshold: 5
    circuit_breaker_timeout_seconds: 60
  
  # Input validation configuration
  validation_config:
    strict_validation: false          # Fail on any validation errors
    max_findings_per_request: 1000   # Maximum findings per request
    min_confidence_threshold: 0.0    # Minimum confidence value
    max_confidence_threshold: 1.0    # Maximum confidence value
    
    # Error handling behavior
    fail_on_invalid_findings: false  # Fail vs. sanitize invalid findings
    use_degraded_scoring_on_errors: true  # Provide fallback scores on errors
    log_validation_errors: true      # Log validation issues
  
  # Advanced features (experimental)
  enable_predictive_scoring: false        # Enable predictive risk scoring
  enable_machine_learning_enhancements: false  # Enable ML enhancements
  enable_external_threat_intelligence: false   # Enable external threat feeds
